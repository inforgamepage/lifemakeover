<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://inforgamepage.github.io/lifemakeover/styles.css">
    <title>Bách khoa Vvanna</title>
</head>
<body class="body-elements">
    <div class="navbar">
        <div class="dropdown">
            <button class="dropdown-btn homepage-icon" id="homepage">Trang chủ</button>   
        </div>
        <div class="dropdown">
            <button class="dropdown-btn infor-icon" onclick="toggleDropdown('inforDropdown')">Thông tin</button>
            <div id="inforDropdown" class="dropdown-content">
                <a href="#">Cốt truyện</a>
                <a href="#">Lầu quay</a>
                <a href="#">Sự kiện</a>
                <a href="#">Mật khẩu thời trang</a>
                <a href="#">Đồng hành</a>
                <a href="#">Chụp ảnh</a>
                <a href="#">Thời trang</a>
            </div>
        </div>
        <div class="dropdown"> 
            <button class="dropdown-btn guilde-icon" onclick="toggleDropdown('guildeDropdown')">Hướng dẫn chơi</button>
            <div id="guildeDropdown" class="dropdown-content">
                <a href="https://inforgamepage.github.io/lifemakeover/bachkhoavvanna.html">Bách khoa Vvanna</a>
                <a href="#">Thử thách Vvanna</a>
            </div>
        </div>
        <div class="dropdown">
            <button class="dropdown-btn globe-icon" onclick="toggleDropdown('languageDropdown')">Ngôn ngữ</button>
            <div id="languageDropdown" class="dropdown-content">
                <a href="quizen.html">English</a>
                <a href="quizindo.html">Bahasa</a>
                <a href="quizth.html">ภาษาไทย</a>
                <a href="quizru.html">Pусский язык</a>
                <a href="https://inforgamepage.github.io/lifemakeover/bachkhoavvanna.html">Tiếng Việt</a>
                <a href="quizcn.html">中文</a>
                <a href="quizkr.html">한글</a>
            </div>
        </div>
        <div class="dropdown">
            <button id="themeToggleBtn" class="dropdown-btn theme-icon" onclick="toggleTheme()" ontouchstart="toggleTheme()">Sáng</button>
        </div>
    </div>

    <div class="main-container qna">
        <h1>Bách khoa Vvanna</h1>
        <input type="text" id="searchBar" placeholder="Tìm kiếm câu hỏi...">
        <div id="questionsContainer"></div>
        <div id="no-result" class="no-result" style="display:none;">
            Không tìm thấy nội dung phù hợp, đảm bảo gõ chính xác hoặc chọn đúng ngôn ngữ và thử lại.
        </div>
    </div>

    <footer class="footer">
        <div class="version">
            <a href="https://lifemakeovermysg.archosaur.com/index_main.html" target="_blank" aria-label="SGMY"><img src="https://play-lh.googleusercontent.com/JDQ0UOe9ClAbObhio8_fSI_c7pZXFzII_BW2nmK9haIAIjHx2PlQk6nILfS652uNKA=w480-h960-rw" alt="SGMY" title="Singapore và Malaysia"></a>
            <a href="https://kirapara.archosaur.com/" target="_blank" aria-label="JP"><img src="https://play-lh.googleusercontent.com/5JfaP0eeOjFXWhEDgHnPr1FIasmDux92zmFlmJQK4wVxZXyKnqS_G_YmaTvwtC7ofQ=s96-rw" alt="JP" title="Nhật Bản"></a>
            <a href="https://mystyle.archosaur.com/home/index.html" target="_blank" aria-label="CN"><img src="https://is1-ssl.mzstatic.com/image/thumb/Purple211/v4/f5/8e/27/f58e27d3-4932-ab75-a7d1-36cd1846fad4/AppIcon-1x_U007emarketing-0-8-0-0-85-220-0.png/434x0w.webp" alt="CN" title="Trung Quốc"></a>
            <a href="https://lifemakeover.archosaur.com/" target="_blank" aria-label="Global"><img src="https://play-lh.googleusercontent.com/aE2tu6k6f4JGjeSb8miztpzoJEoZLkG9XczqxIv4Hkp859MBrsFt5ZOLIWG6Utky4xA=s96-rw" alt="Global" title="Quốc tế"></a>
            <a href="https://lifemakeover.archosaur.com/index_vn.html" target="_blank" aria-label="VN"><img src="https://play-lh.googleusercontent.com/TUA-LHwdqJcwVtO5AQIZOTQ-keYiDuGs2goprebePIWtDaxuAJWzYPZEtBBe8SJARYE=s96-rw" alt="VN" title="Quốc tế (vùng Việt Nam)"></a>
            <a href="https://stylight.nex2fun.com/" target="_blank" aria-label="KR"><img src="https://play-lh.googleusercontent.com/d76GrkcaT-nKISQQmbC-QKP9XPov31qAHbqL_zfBMzPJlSoLnSHmavcQbIyhsDeSBUCvTI9JnPhLHOFYqVMR94Q=s96-rw" alt="KR" title="Hàn Quốc"></a>
        </div>
        <div class="info">
            <p>Chơi quá 180 phút một ngày sẽ ảnh hưởng xấu đến sức khỏe.<br><br>
            Trò chơi điện tử "Life Makeover" là trò chơi dành cho người lớn (từ 18 tuổi trở lên).<br><br>
            Mọi thông tin được tổng hợp dựa trên nội dung từ trò chơi "Life Makeover" của Archosaur Games và thuộc sở hữu của Archosaur Games.</p>
        </div>
    </footer>

<script>
const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vS7HOXwDgQimfgHMvIKOVgSGalxrC361rsoegLJXBW6IyIXdoKgifQGibDm9vcJEH2CMel5vs38OVN_/pub?output=csv";
let entries = [];
let searching = false;

const container = document.getElementById("questionsContainer");
const search = document.getElementById("searchBar");
const noResult = document.getElementById("no-result");

function render(list){
    container.innerHTML = "";
    if(list.length === 0){
        noResult.style.display = "block";
        return;
    }
    noResult.style.display = "none";
    list.forEach(item=>{
        const p = document.createElement("p");
        p.innerHTML = `<strong>Câu hỏi: </strong>${item.question}<br><strong>Đáp án: </strong>${item.answer}`;
        container.appendChild(p);
    });
}

function filterSearch(){
    const kw = search.value.trim().toLowerCase();
    searching = kw.length > 0;
    if(!searching) {
        render(entries);
        return;
    }
    const filtered = entries.filter(item=>
        item.question.toLowerCase().includes(kw) ||
        item.answer.toLowerCase().includes(kw)
    );
    render(filtered);
}

search.addEventListener("input", filterSearch);
search.addEventListener("keypress", e => {
    if(e.key === "Enter") filterSearch();
});

async function fetchCSV(){
    try{
        const response = await fetch(csvUrl);
        const text = await response.text();
        const rows = text.split("\n").slice(1); // bỏ header
        const newEntries = rows.map(r=>{
            // Dùng split CSV thông minh để giữ nguyên dữ liệu xuống dòng trong cùng 1 ô
            const match = r.match(/^(?:"((?:[^"]|"")*)"|([^,]*)),(?:"((?:[^"]|"")*)"|([^,]*))/);
            if(!match) return null;
            const question = (match[1] || match[2] || "").replace(/""/g,'"').trim();
            const answer = (match[3] || match[4] || "").replace(/""/g,'"').trim();
            return {question, answer};
        }).filter(item => item && item.question && item.answer);

        entries = newEntries;
        if(!searching) render(entries);
    }catch(err){
        console.error("Lỗi fetch CSV:", err);
    }
}

// Lần đầu fetch và fetch lại mỗi giây
fetchCSV();
setInterval(fetchCSV, 1000);
</script>

<script src="https://inforgamepage.github.io/lifemakeover/vetrangchu.js"></script>
<script src="https://inforgamepage.github.io/lifemakeover/script.js"></script>
</body>
</html>

